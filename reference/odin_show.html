<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Show generated odin code — odin_show • odin2</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Show generated odin code — odin_show"><meta name="description" content="Show generated code from compiling an odin model."><meta property="og:description" content="Show generated code from compiling an odin model."><meta property="og:image" content="https://mrc-ide.github.io/odin2/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">odin2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.38</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/odin2.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/fitting.html">Fitting odin2 models to data</a></li>
    <li><a class="dropdown-item" href="../articles/debugging.html">Debugging</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Details</h6></li>
    <li><a class="dropdown-item" href="../articles/details.html">Details</a></li>
    <li><a class="dropdown-item" href="../articles/errors.html">Odin parse errors</a></li>
    <li><a class="dropdown-item" href="../articles/functions.html">Supported Functions</a></li>
    <li><a class="dropdown-item" href="../articles/migrating.html">Migrating from odin 1.x.x</a></li>
    <li><a class="dropdown-item" href="../articles/packaging.html">Packaging odin models</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mrc-ide/odin2/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Show generated odin code</h1>
      <small class="dont-index">Source: <a href="https://github.com/mrc-ide/odin2/blob/main/R/odin.R" class="external-link"><code>R/odin.R</code></a></small>
      <div class="d-none name"><code>odin_show.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Show generated code from compiling an odin model.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">odin_show</span><span class="op">(</span></span>
<span>  <span class="va">expr</span>,</span>
<span>  input_type <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  compatibility <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  check_bounds <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  what <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-expr">expr<a class="anchor" aria-label="anchor" href="#arg-expr"></a></dt>
<dd><p>Odin code as the path to a file (a string), a
character vector of code, or as an expression (typically within
braces <code><a href="https://rdrr.io/r/base/Paren.html" class="external-link">{}</a></code>).</p></dd>


<dt id="arg-input-type">input_type<a class="anchor" aria-label="anchor" href="#arg-input-type"></a></dt>
<dd><p>An optional string describing the type of input
for <code>expr</code> - must be one of <code>file</code>, <code>text</code> or <code>expression</code>.  If
given, this skips the type detection logic and odin will throw
an error if the wrong type of input is given.  Using this may be
beneficial in programmatic environments.</p></dd>


<dt id="arg-compatibility">compatibility<a class="anchor" aria-label="anchor" href="#arg-compatibility"></a></dt>
<dd><p>Compatibility mode to use.  Valid options are
"warning", which updates code that can be fixed, with warnings,
and "error", which will error.  The option "silent" will
silently rewrite code, but this is not recommended for general
use as eventually the compatibility mode will be removed (this
option is primarily intended for comparing output of odin1 and
odin2 models against old code).  The default, <code>NULL</code>, currently
corresponds to <code>warning</code>.</p></dd>


<dt id="arg-check-bounds">check_bounds<a class="anchor" aria-label="anchor" href="#arg-check-bounds"></a></dt>
<dd><p>Control over static array bounds checking.
This is enabled by default, but is prone to false positives,
erroring where a read or write appears out of bounds but is
actually ok.  This argument exists to allow you to disable the
check and compile the model anyway.  Future versions may allow
specific lines to be ignored, which will provide finer control
and allow you to use the bits of the checks that are actually
helpful.  You can also pass <code>TRUE</code> here to mean "error" or
<code>FALSE</code> to mean "disabled".</p></dd>


<dt id="arg-what">what<a class="anchor" aria-label="anchor" href="#arg-what"></a></dt>
<dd><p>Optional string, being a single method to show.
Popular options are <code>update</code>, <code>rhs</code> and <code>compare_data</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A character vector, with class <code>odin_code</code> that has a
pretty-print method defined.  Returns <code>NULL</code> if <code>what</code> was given
but the model lacks this part.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Show generated code for the whole system</span></span></span>
<span class="r-in"><span><span class="fu">odin_show</span><span class="op">(</span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu">initial</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">a</span></span></span>
<span class="r-in"><span>  <span class="va">a</span> <span class="op">&lt;-</span> <span class="fu">Normal</span><span class="op">(</span><span class="va">x</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">odin code:</span> <span style="color: #00BBBB;">──────────────────────────────────────────────────────────────────</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> #include &lt;dust2/common.hpp&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> // [[dust2::class(odin_system)]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> // [[dust2::time_type(discrete)]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> class odin_system {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> public:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   odin_system() = delete;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   using real_type = double;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   using rng_state_type = monty::random::generator&lt;real_type&gt;;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   struct shared_state {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     struct odin_internals_type {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       struct {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         dust2::packing state;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       } packing;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       struct {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         std::array&lt;size_t, 1&gt; state;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       } offset;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     } odin;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   };</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   struct internal_state {};</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   using data_type = dust2::no_data;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   static dust2::packing packing_state(const shared_state&amp; shared) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     return shared.odin.packing.state;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   static shared_state build_shared(cpp11::list parameters) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     shared_state::odin_internals_type odin;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     odin.packing.state = dust2::packing{</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       {"x", {}}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     };</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     odin.packing.state.copy_offset(odin.offset.state.begin());</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     return shared_state{odin};</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   static internal_state build_internal(const shared_state&amp; shared) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     return internal_state{};</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   static void update_shared(cpp11::list parameters, shared_state&amp; shared) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   static void update_internal(const shared_state&amp; shared, internal_state&amp; internal) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   static void initial(real_type time, const shared_state&amp; shared, internal_state&amp; internal, rng_state_type&amp; rng_state, real_type* state) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     state[0] = 1;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   static void update(real_type time, real_type dt, const real_type* state, const shared_state&amp; shared, internal_state&amp; internal, rng_state_type&amp; rng_state, real_type* state_next) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     const auto x = state[0];</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     const real_type a = monty::random::normal&lt;real_type&gt;(rng_state, x, 1);</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     state_next[0] = a;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> };</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Just the update method</span></span></span>
<span class="r-in"><span><span class="fu">odin_show</span><span class="op">(</span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu">initial</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">a</span></span></span>
<span class="r-in"><span>  <span class="va">a</span> <span class="op">&lt;-</span> <span class="fu">Normal</span><span class="op">(</span><span class="va">x</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span>, what <span class="op">=</span> <span class="st">"update"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">odin code (update):</span> <span style="color: #00BBBB;">─────────────────────────────────────────────────────────</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> static void update(real_type time, real_type dt, const real_type* state, const shared_state&amp; shared, internal_state&amp; internal, rng_state_type&amp; rng_state, real_type* state_next) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   const auto x = state[0];</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   const real_type a = monty::random::normal&lt;real_type&gt;(rng_state, x, 1);</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   state_next[0] = a;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rich FitzJohn, Wes Hinsley.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

