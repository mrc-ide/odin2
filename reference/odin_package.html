<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Update odin code in package — odin_package • odin2</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Update odin code in package — odin_package"><meta name="description" content="Update generated code in a package that uses odin and dust to
provide a model. This will generate new dust code in inst/dust
and from that generate a full model in src, and an R interface
in R/dust.R, along with the cpp11 attributes that are needed to
use the model."><meta property="og:description" content="Update generated code in a package that uses odin and dust to
provide a model. This will generate new dust code in inst/dust
and from that generate a full model in src, and an R interface
in R/dust.R, along with the cpp11 attributes that are needed to
use the model."><meta property="og:image" content="https://mrc-ide.github.io/odin2/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">odin2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.38</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/odin2.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/fitting.html">Fitting odin2 models to data</a></li>
    <li><a class="dropdown-item" href="../articles/debugging.html">Debugging</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Details</h6></li>
    <li><a class="dropdown-item" href="../articles/details.html">Details</a></li>
    <li><a class="dropdown-item" href="../articles/errors.html">Odin parse errors</a></li>
    <li><a class="dropdown-item" href="../articles/functions.html">Supported Functions</a></li>
    <li><a class="dropdown-item" href="../articles/migrating.html">Migrating from odin 1.x.x</a></li>
    <li><a class="dropdown-item" href="../articles/packaging.html">Packaging odin models</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mrc-ide/odin2/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Update odin code in package</h1>
      <small class="dont-index">Source: <a href="https://github.com/mrc-ide/odin2/blob/main/R/package.R" class="external-link"><code>R/package.R</code></a></small>
      <div class="d-none name"><code>odin_package.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Update generated code in a package that uses odin and dust to
provide a model. This will generate new dust code in <code>inst/dust</code>
and from that generate a full model in <code>src</code>, and an R interface
in <code>R/dust.R</code>, along with the cpp11 attributes that are needed to
use the model.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">odin_package</span><span class="op">(</span><span class="va">path</span>, quiet <span class="op">=</span> <span class="cn">FALSE</span>, compatibility <span class="op">=</span> <span class="cn">NULL</span>, check_bounds <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-path">path<a class="anchor" aria-label="anchor" href="#arg-path"></a></dt>
<dd><p>Path to the package root (the directory that contains
<code>DESCRIPTION</code>), or any path within that package.</p></dd>


<dt id="arg-quiet">quiet<a class="anchor" aria-label="anchor" href="#arg-quiet"></a></dt>
<dd><p>Logical, indicating if compilation messages from
<code>pkgbuild</code> should be displayed.  Error messages will be
displayed on compilation failure regardless of the value used.
If <code>NULL</code> is given, then we take the value from <code>DUST_QUIET</code> if set, or
<code>FALSE</code> otherwise.</p></dd>


<dt id="arg-compatibility">compatibility<a class="anchor" aria-label="anchor" href="#arg-compatibility"></a></dt>
<dd><p>Compatibility mode to use.  Valid options are
"warning", which updates code that can be fixed, with warnings,
and "error", which will error.  The option "silent" will
silently rewrite code, but this is not recommended for general
use as eventually the compatibility mode will be removed (this
option is primarily intended for comparing output of odin1 and
odin2 models against old code).  The default, <code>NULL</code>, currently
corresponds to <code>warning</code>.</p></dd>


<dt id="arg-check-bounds">check_bounds<a class="anchor" aria-label="anchor" href="#arg-check-bounds"></a></dt>
<dd><p>Control over static array bounds checking.
This is enabled by default, but is prone to false positives,
erroring where a read or write appears out of bounds but is
actually ok.  This argument exists to allow you to disable the
check and compile the model anyway.  Future versions may allow
specific lines to be ignored, which will provide finer control
and allow you to use the bits of the checks that are actually
helpful.  You can also pass <code>TRUE</code> here to mean "error" or
<code>FALSE</code> to mean "disabled".</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Invisibly, the path to the package.  However, this
function is typically called for its side effect of updating
files in <code>inst/dust</code> and <code>src</code> within this package after you
have changed the odin code in <code>inst/odin</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function is powered by <a href="https://mrc-ide.github.io/dust2/reference/dust_package.html" class="external-link">dust2::dust_package</a>, and the same
pre-requisites apply here:</p>
<p>For your <code>DESCRIPTION</code> file:</p><ul><li><p><code>dust2</code> must be in <code>Imports</code></p></li>
<li><p><code>cpp11</code>, <code>dust2</code> and <code>monty</code> must be in <code>LinkingTo</code></p></li>
</ul><p>For your <code>NAMESPACE</code> file:</p><ul><li><p>you must have a suitable <code>useDynLib()</code> call with <code>.registration = TRUE</code></p></li>
</ul><p>If you do not satisfy these requirements, <code><a href="https://mrc-ide.github.io/dust2/reference/dust_package.html" class="external-link">dust2::dust_package</a></code>
will fail with a message indicating actions you should take.  Once
set up, generally things will keep working.</p>
<p>If you want your packages to build on GitHub actions, or be
installable via <code>remotes::install_github</code> you should add to your
<code>DESCRIPTION</code>:</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>Remotes<span class="sc">:</span> mrc<span class="sc">-</span>ide<span class="sc">/</span>dust2, mrc<span class="sc">-</span>ide<span class="sc">/</span>monty</span></code></pre><p></p></div>
<p>Note that you do not need to include odin2 itself as a dependency.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="../articles/packaging.html">vignette("packaging")</a></code> for more details, and
<code><a href="https://mrc-ide.github.io/dust2/reference/dust_package.html" class="external-link">dust2::dust_package()</a></code>, which does most of the work here.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># An example package structure</span></span></span>
<span class="r-in"><span><span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/dir_tree.html" class="external-link">dir_tree</a></span><span class="op">(</span><span class="va">path</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB; font-weight: bold;">/tmp/RtmpOTkvAB/file1c965344430c</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ├── DESCRIPTION</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ├── NAMESPACE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> └── <span style="color: #0000BB; font-weight: bold;">inst</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     └── <span style="color: #0000BB; font-weight: bold;">odin</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         └── <span style="color: #00BB00;">sir.R</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate odin code:</span></span></span>
<span class="r-in"><span><span class="fu">odin_package</span><span class="op">(</span><span class="va">path</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Found 1 odin code file in 'inst/odin'</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Wrote 'inst/dust/sir.cpp'</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Working in package 'example' at '/tmp/RtmpOTkvAB/file1c965344430c'</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Found 1 system</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Wrote 'src/sir.cpp'</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Wrote 'R/dust.R'</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Wrote 'src/Makevars'</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> 12 functions decorated with [[cpp11::register]]</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> generated file <span style="color: #0000BB;">cpp11.R</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> generated file <span style="color: #0000BB;">cpp11.cpp</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Resulting files:</span></span></span>
<span class="r-in"><span><span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/dir_tree.html" class="external-link">dir_tree</a></span><span class="op">(</span><span class="va">path</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB; font-weight: bold;">/tmp/RtmpOTkvAB/file1c965344430c</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ├── DESCRIPTION</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ├── NAMESPACE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ├── <span style="color: #0000BB; font-weight: bold;">R</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> │   ├── <span style="color: #00BB00;">cpp11.R</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> │   └── <span style="color: #00BB00;">dust.R</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ├── <span style="color: #0000BB; font-weight: bold;">inst</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> │   ├── <span style="color: #0000BB; font-weight: bold;">dust</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> │   │   └── sir.cpp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> │   └── <span style="color: #0000BB; font-weight: bold;">odin</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> │       └── <span style="color: #00BB00;">sir.R</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> └── <span style="color: #0000BB; font-weight: bold;">src</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ├── Makevars</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ├── cpp11.cpp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     └── sir.cpp</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rich FitzJohn, Wes Hinsley.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

